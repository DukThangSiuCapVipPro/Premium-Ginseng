<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chi ti·∫øt s·∫£n ph·∫©m</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap');

*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family:'Inter', Arial, sans-serif;
  background:#0a0a0a;
  color:#f0e6d3;
  -webkit-font-smoothing:antialiased;
}

/* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
.header {
  background:#141414;
  position:sticky;
  top:0;
  z-index:100;
  box-shadow:0 1px 0 rgba(201,168,76,0.3);
  border-bottom:1px solid #2a2a2a;
}
.header-inner {
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 16px;
  max-width:1200px;
  margin:0 auto;
}
.btn-back {
  width:36px;
  height:36px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#1e1e1e;
  border:none;
  border-radius:50%;
  cursor:pointer;
  font-size:18px;
  color:#c9a84c;
  transition:background 0.2s;
  flex-shrink:0;
}
.btn-back:hover { background:#2a2a2a; }
.header-title {
  font-size:16px;
  font-weight:600;
  color:#f0e6d3;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  flex:1;
}

/* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
.page {
  max-width:1200px;
  margin:0 auto;
}

/* ‚îÄ‚îÄ Gallery ‚îÄ‚îÄ */
.gallery-section {
  background:#141414;
}
.gallery {
  position:relative;
  overflow:hidden;
  max-width:600px;
  margin:0 auto;
}
.gallery-track {
  display:flex;
  transition:transform 0.35s cubic-bezier(0.25,0.8,0.25,1);
}
.gallery-track img {
  width:100%;
  min-width:100%;
  object-fit:contain;
  display:block;
  background:#1a1a1a;
}
.gallery-btn {
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:40px;
  height:40px;
  border-radius:50%;
  background:rgba(20,20,20,0.9);
  border:1px solid #333;
  font-size:20px;
  font-weight:bold;
  cursor:pointer;
  z-index:2;
  display:none;
  align-items:center;
  justify-content:center;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
  color:#c9a84c;
  transition:background 0.2s, transform 0.2s;
}
.gallery-btn:hover {
  background:rgba(30,30,30,0.95);
  transform:translateY(-50%) scale(1.08);
}
.gallery-btn.left { left:12px; }
.gallery-btn.right { right:12px; }

.gallery-counter {
  position:absolute;
  bottom:12px;
  right:12px;
  background:rgba(0,0,0,0.55);
  color:#fff;
  font-size:12px;
  font-weight:500;
  padding:4px 10px;
  border-radius:12px;
  display:none;
}

.gallery-dots {
  text-align:center;
  padding:12px 0;
  background:#141414;
  display:none;
}
.gallery-dots .dot {
  display:inline-block;
  width:8px;
  height:8px;
  border-radius:50%;
  background:#333;
  margin:0 4px;
  cursor:pointer;
  transition:all 0.2s;
}
.gallery-dots .dot.active {
  background:#c9a84c;
  transform:scale(1.2);
}

/* ‚îÄ‚îÄ Thumbnail strip ‚îÄ‚îÄ */
.thumb-strip {
  display:none;
  gap:8px;
  padding:12px 16px;
  background:#141414;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.thumb-strip::-webkit-scrollbar { height:0; }
.thumb-strip img {
  width:64px;
  height:64px;
  object-fit:cover;
  border-radius:8px;
  cursor:pointer;
  border:2px solid transparent;
  transition:border-color 0.2s, opacity 0.2s;
  flex-shrink:0;
}
.thumb-strip img.active {
  border-color:#c9a84c;
}
.thumb-strip img:hover { opacity:0.8; }

/* ‚îÄ‚îÄ Product Info ‚îÄ‚îÄ */
.product-detail {
  background:#141414;
  margin-top:8px;
  padding:20px 16px;
}
.product-title {
  font-size:20px;
  font-weight:700;
  color:#f0e6d3;
  font-family:'Playfair Display', serif;
  line-height:1.4;
  margin-bottom:12px;
}
.product-meta {
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:16px;
  flex-wrap:wrap;
}
.meta-tag {
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:5px 10px;
  background:#1e1e1e;
  border-radius:6px;
  font-size:12px;
  color:#a09880;
  font-weight:500;
  border:1px solid #2a2a2a;
}
.meta-tag svg { width:14px; height:14px; }

.description-section {
  margin-top:16px;
}
.desc-label {
  font-size:14px;
  font-weight:600;
  color:#c9a84c;
  margin-bottom:8px;
  font-family:'Playfair Display', serif;
}
.description {
  background:linear-gradient(135deg, #0d1a0f, #1a2e1f);
  color:#8fbc8f;
  padding:16px;
  border-radius:12px;
  font-size:14px;
  line-height:1.7;
  white-space:pre-wrap;
  border-left:4px solid #2d5a3d;
}

/* ‚îÄ‚îÄ Order Form ‚îÄ‚îÄ */
.order-section {
  background:#141414;
  margin-top:8px;
  padding:20px 16px;
}
.order-section h3 {
  font-size:17px;
  font-weight:700;
  color:#f0e6d3;
  font-family:'Playfair Display', serif;
  margin-bottom:16px;
  display:flex;
  align-items:center;
  gap:8px;
}
.order-section h3 svg { width:20px; height:20px; color:#c9a84c; }

.form-row {
  margin-bottom:14px;
}
.form-row label {
  display:block;
  font-size:13px;
  font-weight:500;
  color:#a09880;
  margin-bottom:5px;
}
.form-row input {
  width:100%;
  padding:12px 14px;
  border:1.5px solid #333;
  border-radius:10px;
  font-size:14px;
  font-family:inherit;
  outline:none;
  transition:border-color 0.2s, box-shadow 0.2s;
  background:#1a1a1a;
  color:#f0e6d3;
}
.form-row input:focus {
  border-color:#c9a84c;
  box-shadow:0 0 0 3px rgba(201,168,76,0.15);
  background:#1e1e1e;
}
.form-row input::placeholder { color:#555; }

.quantity-wrap {
  display:flex;
  align-items:center;
  gap:0;
  max-width:160px;
}
.qty-btn {
  width:40px;
  height:42px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#1e1e1e;
  border:1.5px solid #333;
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
  color:#c9a84c;
  transition:background 0.2s;
  user-select:none;
}
.qty-btn:first-child { border-radius:10px 0 0 10px; }
.qty-btn:last-child { border-radius:0 10px 10px 0; }
.qty-btn:hover { background:#2a2a2a; }
.quantity-wrap input {
  width:60px;
  text-align:center;
  border-radius:0;
  border-left:none;
  border-right:none;
  -moz-appearance:textfield;
  background:#1a1a1a;
}
.quantity-wrap input::-webkit-inner-spin-button,
.quantity-wrap input::-webkit-outer-spin-button { -webkit-appearance:none; }

.btn-submit {
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  width:100%;
  padding:15px;
  background:linear-gradient(135deg, #c9a84c, #b8860b);
  color:#0a0a0a;
  font-weight:700;
  font-size:16px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:20px;
  transition:opacity 0.2s, transform 0.2s;
  font-family:inherit;
  box-shadow:0 4px 14px rgba(201,168,76,0.3);
}
.btn-submit:hover { opacity:0.92; transform:translateY(-1px); }
.btn-submit:active { transform:scale(0.98); }
.btn-submit:disabled {
  background:#ccc;
  cursor:not-allowed;
  box-shadow:none;
  transform:none;
}
.btn-submit svg { width:20px; height:20px; }

/* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
.footer {
  text-align:center;
  padding:20px 16px;
  color:#666;
  font-size:12px;
  margin-top:8px;
}

/* ‚îÄ‚îÄ Desktop Layout ‚îÄ‚îÄ */
@media (min-width:768px) {
  .page-grid {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:0;
    max-width:1200px;
    margin:20px auto;
    background:#141414;
    border-radius:16px;
    overflow:hidden;
    box-shadow:0 2px 12px rgba(0,0,0,0.3);
    border:1px solid #2a2a2a;
  }
  .gallery-section { border-radius:0; }
  .gallery { max-width:100%; }
  .thumb-strip { display:flex; }
  .detail-side {
    padding:0;
    display:flex;
    flex-direction:column;
  }
  .product-detail { margin-top:0; box-shadow:none; }
  .order-section { margin-top:0; box-shadow:none; border-top:1px solid #2a2a2a; }
  .product-title { font-size:24px; }
  .header-inner { padding:14px 24px; }
  .header-title { font-size:18px; }
}
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="header-inner">
    <button class="btn-back" onclick="window.location.href='index.html'" aria-label="Quay l·∫°i">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
    </button>
    <div class="header-title" id="title">ƒêang t·∫£i...</div>
  </div>
</div>

<div class="page">
  <div class="page-grid">
    <!-- Left / Top: Gallery -->
    <div class="gallery-col">
      <div class="gallery-section">
        <div class="gallery" id="gallery">
          <div class="gallery-track" id="gallery-track"></div>
          <button class="gallery-btn left" id="btn-left" onclick="changeSlide(-1)">&lsaquo;</button>
          <button class="gallery-btn right" id="btn-right" onclick="changeSlide(1)">&rsaquo;</button>
          <div class="gallery-counter" id="gallery-counter"></div>
        </div>
        <div class="gallery-dots" id="gallery-dots"></div>
        <div class="thumb-strip" id="thumb-strip"></div>
      </div>
    </div>

    <!-- Right / Bottom: Details -->
    <div class="detail-side">
      <div class="product-detail">
        <h1 class="product-title" id="product-title">ƒêang t·∫£i...</h1>

        <div class="product-meta">
          <span class="meta-tag">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
            C√≤n h√†ng
          </span>
          <span class="meta-tag">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
            Giao h√†ng to√†n qu·ªëc
          </span>
        </div>

        <div class="description-section">
          <div class="desc-label">M√¥ t·∫£ s·∫£n ph·∫©m</div>
          <div class="description" id="description">ƒêang t·∫£i m√¥ t·∫£...</div>
        </div>
      </div>

      <div class="order-section">
        <h3>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/></svg>
          ƒê·∫∑t h√†ng
        </h3>

        <div class="form-row">
          <label for="customer-name">H·ªç t√™n</label>
          <input id="customer-name" placeholder="Nh·∫≠p h·ªç t√™n c·ªßa b·∫°n" required>
        </div>

        <div class="form-row">
          <label for="customer-phone">S·ªë ƒëi·ªán tho·∫°i</label>
          <input id="customer-phone" type="tel" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
        </div>

        <div class="form-row">
          <label for="customer-address">ƒê·ªãa ch·ªâ giao h√†ng</label>
          <input id="customer-address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ nh·∫≠n h√†ng" required>
        </div>

        <div class="form-row">
          <label>S·ªë l∆∞·ª£ng</label>
          <div class="quantity-wrap">
            <button class="qty-btn" type="button" onclick="adjustQty(-1)">&minus;</button>
            <input id="customer-quantity" type="number" min="1" value="1" required>
            <button class="qty-btn" type="button" onclick="adjustQty(1)">+</button>
          </div>
        </div>

        <button class="btn-submit" id="btn-submit" onclick="sendOrder()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
          Ho√†n th√†nh ƒë·∫∑t h√†ng
        </button>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  &copy; 2025 ShopVN Store
</div>

<script>
const params = new URLSearchParams(window.location.search);
const product = params.get("product");

if (!product) {
  window.location.href = "index.html";
}

const productDecoded = decodeURIComponent(product);
const productEncoded = encodeURIComponent(product);

document.getElementById("title").textContent = productDecoded;
document.getElementById("product-title").textContent = productDecoded;
document.title = productDecoded + " - Chi ti·∫øt s·∫£n ph·∫©m";

// ‚îÄ‚îÄ Gallery ‚îÄ‚îÄ
const track = document.getElementById("gallery-track");
const dotsContainer = document.getElementById("gallery-dots");
const thumbStrip = document.getElementById("thumb-strip");
const counterEl = document.getElementById("gallery-counter");
const btnLeft = document.getElementById("btn-left");
const btnRight = document.getElementById("btn-right");
let currentSlide = 0;
let totalSlides = 0;

function tryLoadImage(basePath) {
  return new Promise(resolve => {
    const img = new Image();
    img.onload = () => resolve(basePath);
    img.onerror = () => {
      if (basePath.endsWith(".png")) {
        const jpgPath = basePath.replace(/\.png$/, ".jpg");
        const img2 = new Image();
        img2.onload = () => resolve(jpgPath);
        img2.onerror = () => resolve(null);
        img2.src = jpgPath;
      } else {
        resolve(null);
      }
    };
    img.src = basePath;
  });
}

async function loadGallery() {
  const basePath = `products/${productEncoded}`;
  const images = [];

  const avatarSrc = await tryLoadImage(`${basePath}/avatar.png`);
  if (avatarSrc) images.push(avatarSrc);

  for (let i = 1; i <= 20; i++) {
    const src = await tryLoadImage(`${basePath}/${i}.png`);
    if (src) {
      images.push(src);
    }
  }

  if (images.length === 0) {
    track.innerHTML = '<img src="" alt="No image" style="background:#e0e0e0;">';
    return;
  }

  totalSlides = images.length;

  images.forEach((src, i) => {
    const img = document.createElement("img");
    img.src = src;
    img.alt = `${productDecoded} - ${i + 1}`;
    track.appendChild(img);

    // Thumbnails
    const thumb = document.createElement("img");
    thumb.src = src;
    thumb.alt = `Thumbnail ${i + 1}`;
    thumb.className = i === 0 ? "active" : "";
    thumb.addEventListener("click", () => goToSlide(i));
    thumbStrip.appendChild(thumb);
  });

  if (totalSlides > 1) {
    btnLeft.style.display = "flex";
    btnRight.style.display = "flex";
    dotsContainer.style.display = "block";
    counterEl.style.display = "block";

    for (let i = 0; i < totalSlides; i++) {
      const dot = document.createElement("span");
      dot.className = "dot" + (i === 0 ? " active" : "");
      dot.addEventListener("click", () => goToSlide(i));
      dotsContainer.appendChild(dot);
    }
    updateUI();
  }
}

function goToSlide(index) {
  currentSlide = index;
  track.style.transform = `translateX(-${currentSlide * 100}%)`;
  updateUI();
}

function changeSlide(dir) {
  const next = currentSlide + dir;
  if (next < 0 || next >= totalSlides) return;
  goToSlide(next);
}

function updateUI() {
  // Dots
  dotsContainer.querySelectorAll(".dot").forEach((d, i) =>
    d.classList.toggle("active", i === currentSlide)
  );
  // Counter
  counterEl.textContent = `${currentSlide + 1} / ${totalSlides}`;
  // Arrows opacity
  btnLeft.style.opacity = currentSlide === 0 ? "0.3" : "1";
  btnRight.style.opacity = currentSlide === totalSlides - 1 ? "0.3" : "1";
  // Thumbnails
  thumbStrip.querySelectorAll("img").forEach((t, i) => {
    t.classList.toggle("active", i === currentSlide);
    if (i === currentSlide) t.scrollIntoView({ behavior:"smooth", block:"nearest", inline:"center" });
  });
}

// Touch/swipe
let touchStartX = 0;
const gallery = document.getElementById("gallery");
gallery.addEventListener("touchstart", e => {
  touchStartX = e.touches[0].clientX;
}, { passive: true });
gallery.addEventListener("touchend", e => {
  const diff = touchStartX - e.changedTouches[0].clientX;
  if (Math.abs(diff) > 50) changeSlide(diff > 0 ? 1 : -1);
});

loadGallery();

// ‚îÄ‚îÄ Description ‚îÄ‚îÄ
fetch(`products/${productEncoded}/description.txt`)
  .then(res => {
    if (!res.ok) throw new Error("Not found");
    return res.text();
  })
  .then(text => {
    document.getElementById("description").textContent = text || "Ch∆∞a c√≥ m√¥ t·∫£.";
  })
  .catch(() => {
    document.getElementById("description").textContent = "Ch∆∞a c√≥ m√¥ t·∫£.";
  });

// ‚îÄ‚îÄ Pre-fill from last order ‚îÄ‚îÄ
const lastOrder = JSON.parse(localStorage.getItem("lastOrder") || "{}");
if (lastOrder.name) document.getElementById("customer-name").value = lastOrder.name;
if (lastOrder.phone) document.getElementById("customer-phone").value = lastOrder.phone;
if (lastOrder.address) document.getElementById("customer-address").value = lastOrder.address;

// ‚îÄ‚îÄ Quantity ‚îÄ‚îÄ
function adjustQty(delta) {
  const input = document.getElementById("customer-quantity");
  const newVal = Math.max(1, parseInt(input.value || 1) + delta);
  input.value = newVal;
}

// ‚îÄ‚îÄ Send Order ‚îÄ‚îÄ
function sendOrder() {
  const customerName = document.getElementById("customer-name").value.trim();
  const customerPhone = document.getElementById("customer-phone").value.trim();
  const customerAddress = document.getElementById("customer-address").value.trim();
  const customerQuantity = document.getElementById("customer-quantity").value;

  if (!customerName) return alert("Vui l√≤ng nh·∫≠p h·ªç t√™n.");
  if (!customerPhone) return alert("Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i.");
  if (!customerAddress) return alert("Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ.");
  if (!customerQuantity || customerQuantity < 1) return alert("Vui l√≤ng nh·∫≠p s·ªë l∆∞·ª£ng h·ª£p l·ªá.");

  const msg =
`üõí ƒê∆†N H√ÄNG M·ªöI
üì¶ S·∫£n ph·∫©m: ${productDecoded}
üë§ H·ªç t√™n: ${customerName}
üìû SƒêT: ${customerPhone}
üè† ƒê·ªãa ch·ªâ: ${customerAddress}
üî¢ S·ªë l∆∞·ª£ng: ${customerQuantity}`;

  const btn = document.getElementById("btn-submit");
  btn.disabled = true;
  btn.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg> ƒêang g·ª≠i...`;

  fetch(`https://api.telegram.org/bot8198720098:AAGOJWlG6Z43TKRRFX84yTfA7KN8IhZ5J5E/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: "2055542642",
      text: msg
    })
  })
  .then(res => {
    if (!res.ok) throw new Error("Send failed");
    localStorage.setItem("lastOrder", JSON.stringify({ name: customerName, phone: customerPhone, address: customerAddress }));
    btn.innerHTML = `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg> ƒê·∫∑t h√†ng th√†nh c√¥ng!`;
    btn.style.background = "linear-gradient(135deg, #4caf50, #66bb6a)";
    alert("ƒê·∫∑t h√†ng th√†nh c√¥ng! Ch√∫ng t√¥i s·∫Ω li√™n h·ªá b·∫°n s·ªõm.");
  })
  .catch(() => {
    alert("G·ª≠i ƒë∆°n h√†ng th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.");
    btn.disabled = false;
    btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg> Ho√†n th√†nh ƒë·∫∑t h√†ng`;
  });
}
</script>

</body>
</html>
